<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Login</title>

  <style>
    :root { color-scheme: light dark; }
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 2rem; }
    main { max-width: 420px; margin: 0 auto; }
    h1 { margin-bottom: .5rem; }
    p.muted { color: #6b7280; margin-top: 0; }
    form { display: grid; gap: .75rem; margin-top: 1rem; }
    label { display: grid; gap: .35rem; }
    input { padding: .6rem .75rem; font-size: 1rem; border: 1px solid #d1d5db; border-radius: .5rem; }
    button { padding: .6rem .9rem; font-size: 1rem; border-radius: .5rem; border: 1px solid transparent; background: #2563eb; color: white; cursor: pointer; }
    button:hover { background: #1d4ed8; }
    .alert { padding: .6rem .8rem; border-radius: .5rem; border: 1px solid #f5c6cb; background: #fdecea; color: #611a15; }
    .ok { padding: .6rem .8rem; border-radius: .5rem; border: 1px solid #84e1bc; background: #e6ffed; color: #03543f; }
    .links { margin-top: .75rem; }
    a { color: #2563eb; text-decoration: none; }
    a:hover { text-decoration: underline; }

    .input-with-toggle {
      position: relative;
      display: grid;
    }
    .input-with-toggle input { padding-right: 2.4rem; }
    .input-with-toggle button.pw-toggle {
      position: absolute; right: .4rem; top: 50%; transform: translateY(-50%);
      border: none; background: transparent; color: #4b5563; cursor: pointer;
      padding: .25rem; border-radius: .35rem; line-height: 1; font-size: 1.1rem;
    }
    .input-with-toggle button.pw-toggle:hover { background: #f3f4f6; }
    @media (prefers-color-scheme: dark) {
      .input-with-toggle button.pw-toggle:hover { background: #1f2937; }
    }
  </style>

  <!-- Script /static/js -->
  <script defer th:src="@{/js/script_show_pwd.js}"></script>
</head>

<body>
<main>
  <h1>Login</h1>
  <p class="muted">Log in to access the secure area.</p>

  <!-- Status messages -->
  <div th:if="${param.registered}" class="ok">Registration successful. You can now log in.</div>
  <div th:if="${param.required}" class="alert">Please log in to access this page.</div>
  <div th:if="${param.logout}" class="ok">You have been logged out.</div>
  <div th:if="${loginError}" class="alert" th:text="${loginError}">Invalid email or password.</div>

  <form th:action="@{/login}" method="post" th:object="${form}">
    <!-- <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/> -->

    <label>
      Email
      <input type="email" th:field="*{email}" placeholder="email@domain.com" autocomplete="username" required/>
    </label>

    <label>
      Password
      <div class="input-with-toggle">
        <input id="login-password"
               type="password"
               th:field="*{password}"
               placeholder="********"
               autocomplete="current-password"
               required/>
        <button type="button"
                class="pw-toggle"
                aria-label="Afficher le mot de passe"
                aria-pressed="false"
                title="Afficher le mot de passe"
                onclick="togglePasswordIcon('login-password', this)">ðŸ™ˆ</button>
      </div>
    </label>

    <button type="submit">Log in</button>
  </form>

  <div class="links">
    <span>Don't have an account?</span>
    <a th:href="@{/register}">Create an account</a>
  </div>
</main>
</body>
</html> 